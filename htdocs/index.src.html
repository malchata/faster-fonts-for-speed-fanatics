<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="robots" content="noindex, nofollow, nocache">
    <title>Faster Fonts for Speed Fanatics</title>
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/speed.css">
    <link rel="stylesheet" href="lib/css/zenburn.css">
  </head>
  <body>
    <a class="twitter" href="https://twitter.com/malchata" rel="noopener">@malchata</a>
    <div class="reveal">
      <div class="slides">
        <!-- [0.0] - Intro -->
        <section>
          <!-- [0.1] - Title Card -->
          <section data-state="bookend title-card">
            <div class="title-container">
              <h2 class="accent">Faster Fonts</h2>
              <h3 class="accent">for</h3>
              <h2 class="accent">Speed Fanatics</h2>
              <div class="author-info">
                <h6 class="accent">@malchata &mdash; jeremywagner.me</h6>
              </div>
            </div>
          </section>
          <!-- [0.2] - Sponsor Logos -->
          <section data-background="#ffffff" data-state="centered">
            <img class="stretch" src="img/sponsor-logos.png" alt="Prairie Dev Con 2018 sponsors">
          </section>
          <!-- [0.3] - Hello! -->
          <section data-state="centered">
            <h3 class="accent">I'm Jeremy!</h3>
            <img class="stretch" src="img/me.jpg" alt="It's me, Jeremy!">
          </section>
        </section>
        <!-- [1.0] - How Browsers Render Fonts -->
        <section>
          <!-- [1.1] - How Browsers Render Fonts -->
          <section data-state="section-slide">
            <div class="unfocused-heading">
              <h4>&nbsp;</h4>
              <h3 class="accent">&nbsp;</h3>
            </div>
            <div class="focused-heading">
              <h2>How browsers</h2>
              <h1 class="accent">render fonts</h1>
            </div>
            <div class="unfocused-heading">
              <h4>Host fonts</h4>
              <h3 class="accent">on your own server</h3>
            </div>
          </section>
          <!-- [1.2] - Fonts load differently than other resources -->
          <section class="statement-slide">
            <h2>Fonts load differently than</h2>
            <h1 class="accent">other resources</h1>
          </section>
          <!-- [1.3] - A quick recap of resource loading -->
          <section data-state="blackboard centered">
            <h2>A quick recap of</h2>
            <h1 class="accent">resource loading</h1>
          </section>
          <!-- [1.4] - Meet the crew -->
          <section data-state="blackboard centered">
            <h1 class="accent">meet the crew</h1>
          </section>
          <!-- [1.5] - Server -->
          <section data-state="blackboard centered">
            <img src="img/server.svg" alt="A cartoony drawing of a web server.">
            <h2 class="accent">server</h2>
          </section>
          <!-- [1.6] - Browser -->
          <section data-state="blackboard centered">
            <img src="img/browser.svg" alt="A cartoony drawing of a browser.">
            <h2 class="accent">browser</h2>
          </section>
          <!-- [1.7] - Resource -->
          <section data-state="blackboard centered">
            <img src="img/resource.svg" alt="A cartoony drawing of a page resource.">
            <h2 class="accent">resource</h2>
          </section>
          <!-- [1.8] - Witness the action -->
          <section data-state="blackboard centered">
            <h1 class="accent">witness the action</h1>
          </section>
          <!-- [1.9] - The browser requests a resource -->
          <section data-state="blackboard centered">
            <img src="img/request.svg" alt="A cartoony drawing of a browser requesting a resource.">
            <h2 class="accent">request</h2>
          </section>
          <!-- [1.10] - Response -->
          <section data-state="blackboard centered">
            <img src="img/response.svg" alt="A cartoony drawing of a web server sending a response.">
            <h2 class="accent">response</h2>
          </section>
          <!-- [1.11] - Intermission -->
          <section data-state="blackboard centered">
            <h2>render blocking</h2>
            <h1 class="accent">in progress...</h1>
          </section>
          <!-- [1.12] - Render -->
          <section data-state="blackboard centered">
              <img src="img/paint.svg" alt="A cartoony drawing of a browser holding up a paint brush.">
              <h2 class="accent">render</h2>
          </section>
          <!-- [1.13] - Rendering block is all about priorities -->
          <section class="statement-slide">
            <h2>Render blocking is</h2>
            <h1 class="accent">all about priorities</h1>
          </section>
          <!-- [1.14] - When it comes to fonts, browser speculate -->
          <section class="statement-slide">
            <h2>When it comes to fonts,</h2>
            <h1 class="accent">browsers speculate</h1>
          </section>
          <!-- [1.15] - Font loading in pictures (Pt. I) -->
          <section data-state="centered">
            <h2>Font loading in pictures</h2>
            <picture>
              <source srcset="img/font-loading-01.webp" type="image/webp">
              <img class="stretch" src="img/font-loading-01.jpg" alt="A web browser loading fonts on a page, with no text visible yet.">
            </picture>
            <h3>1.89 s</h3>
          </section>
          <!-- [1.16] - Font loading in pictures (Pt. II) -->
          <section data-state="centered">
            <h2>Font loading in pictures</h2>
            <picture>
              <source srcset="img/font-loading-02.webp" type="image/webp">
              <img class="stretch" src="img/font-loading-02.jpg" alt="A web browser loading fonts on a page, with only heading text visible (but not body copy).">
            </picture>
            <h3>2.31 s</h3>
          </section>
          <!-- [1.17] - Font loading in pictures (Pt. III) -->
          <section data-state="centered">
            <h2>Font loading in pictures</h2>
            <picture>
              <source srcset="img/font-loading-03.webp" type="image/webp">
              <img class="stretch" src="img/font-loading-03.jpg" alt="A web browser after loading all fonts on a page, with all text now visible.">
            </picture>
            <h3>2.42 s</h3>
          </section>
          <!-- [1.18] - Web fonts are ripe for fine-tuning -->
          <section class="statement-slide">
            <h2>Web fonts are ripe for</h2>
            <h1 class="accent">performance tuning</h1>
          </section>
        </section>
        <!-- [2.0] - Host fonts on your own server -->
        <section>
          <!-- [2.1] - Host fonts on your own server -->
          <section data-state="section-slide">
            <div class="unfocused-heading">
              <h4>How browsers</h4>
              <h3 class="accent">render fonts</h3>
            </div>
            <div class="focused-heading">
              <h2>Host fonts</h2>
              <h1 class="accent">on your own server</h1>
            </div>
            <div class="unfocused-heading">
              <h4><code>font-display</code> for better</h4>
              <h3 class="accent">rendering control</h3>
            </div>
          </section>
          <!-- [2.2] - What we often do -->
          <section data-state="raccoon centered">
            <h3>What we often do</h3>
            <picture id="raccoon">
              <source srcset="img/raccoon.webp" type="image/webp">
              <img src="img/raccoon.gif" alt="A raccoon stealing a literal font &lt;link&gt; tag from a bowl of cat food and running away.">
            </picture>
          </section>
          <!-- [2.3] - Host your own fonts for performance -->
          <section class="statement-slide">
              <h2>Host your own fonts</h2>
              <h1 class="accent">for performance</h1>
          </section>
          <!-- [2.4] - Fewer hosts equals less latency -->
          <section class="statement-slide">
            <h2>Fewers hosts equals</h2>
            <h1 class="accent">less latency</h1>
          </section>
          <!-- [2.5] - Cross-origin font requests -->
          <section>
            <h2>Cross-origin fonts:</h2>
            <picture>
              <source srcset="img/cross-origin-fonts.webp" type="image/webp">
              <img class="stretch" src="img/cross-origin-fonts.png" alt="A waterfall chart in Chrome dev tools showing the latency involved with cross-origin font requests.">
            </picture>
            <h3>Speed Index: 3,798</h3>
            <h5>WebPagetest: Slow 3G. Dulles, VA. Emulated Motorola G (Gen4)</h5>
          </section>
          <!-- [2.6] - Same-origin font requests -->
          <section>
            <h2>Same-origin fonts:</h2>
            <picture>
              <source srcset="img/same-origin-fonts.webp" type="image/webp">
              <img class="stretch" src="img/same-origin-fonts.png" alt="A waterfall chart in Chrome dev tools showing reducing latency with same origin font requests.">
            </picture>
            <h3>Speed Index: 2,474 <span class="fragment">(~35% improvement)</span></h3>
            <h5>WebPagetest: Slow 3G. Dulles, VA. Emulated Motorola G (Gen4)</h5>
          </section>
          <!-- [2.7] - Try `rel=preconnect` when hosting your own fonts just isn't doable -->
          <section class="statement-slide">
            <h2>Try <code>rel=preconnect</code> when hosting your own fonts</h2>
            <h1 class="accent">just isn't doable</h1>
          </section>
          <!-- [2.8] - Using `rel=preconnect` -->
          <section>
            <div>
              <h3>In HTML:</h3>
              <pre><code class="html">&lt;link rel=&quot;preconnect&quot;
      href=&quot;https://fonts.googleapis.com/&quot;
      crossorigin&gt;
&lt;link rel=&quot;preconnect&quot;
      href=&quot;https://fonts.gstatic.com/&quot;
      crossorigin&gt;</code></pre>
            </div>
            <div class="fragment">
              <h3>As an HTTP response header:</h3>
              <pre><code class="http">Link: &lt;https://fonts.googleapis.com/&gt;;
      rel=preconnect;
      crossorigin,
      &lt;https://fonts.gstatic.com/&gt;;
      rel=preconnect;
      crossorigin</code></pre>
            </div>
          </section>
          <!-- [2.9] - Without `rel=preconnect` -->
          <section>
            <h2>Without <code>rel=preconnect</code>:</h2>
            <picture>
              <source srcset="img/no-preconnect.webp" type="image/webp">
              <img src="img/no-preconnect.png" alt="A browser trace showing increased latency for font requests without `rel=preconnect` in use.">
            </picture>
            <h3>Speed Index: 3,877</h3>
            <h5>WebPagetest: Slow 3G. Dulles, VA. Emulated Motorola G (Gen4)</h5>
          </section>
          <!-- [2.10] - With `rel=preconnect` -->
          <section>
            <h2>With <code>rel=preconnect</code>:</h2>
            <picture>
              <source srcset="img/preconnect.webp" type="image/webp">
              <img src="img/preconnect.png" alt="A browser trace showing decreased latency for font requests without `rel=preconnect` in use.">
            </picture>
            <h3>Speed Index: 3,619 <span class="fragment">(~7% improvement)</span></h3>
            <h5>WebPagetest: Slow 3G. Dulles, VA. Emulated Motorola G (Gen4)</h5>
          </section>
          <!-- [2.11] - Friendly reminder: Don't forget about `crossorigin` -->
          <section data-state="warning">
            <h1 class="accent">Friendly reminder:</h1>
            <h3>Don't forget about <code>crossorigin</code></h3>
          </section>
          <!-- [2.12] - `rel=preconnect` Support -->
          <section>
            <h3><code>rel=preconnect</code> support:</h3>
            <picture>
              <source srcset="img/preconnect-support-2x.webp 2x, img/preconnect-support-1x.webp 1x" type="image/webp">
              <source srcset="img/preconnect-support-2x.png 2x, img/preconnect-support-1x.png 1x" type="image/png">
              <img src="img/preconnect-support-1x.png" alt="Browser suppport matrix for rel=preconnect on caniuse.com">
            </picture>
          </section>
          <!-- [2.13] - Nothing bad is going to happen! -->
          <section class="statement-slide">
            <h2>
              Browser doesn't support<br>
              <code>rel=preconnect</code>?
            </h2>
            <h1 class="accent fragment">Nothing bad is going to happen!</h1>
          </section>
          <!-- [2.14] - Catastrophe! -->
          <section class="statement-slide" data-state="centered catastrophe">
            <picture id="catastrophe">
              <source srcset="img/catastrophe.webp" type="image/webp">
              <img src="img/catastrophe.gif" class="stretch" alt="A tractor launching its engine out of the chassis in an explosion.">
            </picture>
          </section>
          <!-- [2.15] - `rel=dns-prefetch` is also an option -->
          <section class="statement-slide">
            <h2><code>rel=dns-prefetch</code></h2>
            <h1 class="accent">is also an option</h1>
          </section>
          <!-- [2.16] - Using `rel=dns-prefetch` -->
          <section>
            <div>
              <h3>In HTML:</h3>
              <pre><code class="html">&lt;link rel=&quot;dns-prefetch&quot;
      href=&quot;https://fonts.googleapis.com/&quot;
      crossorigin&gt;
&lt;link rel=&quot;dns-prefetch&quot;
      href=&quot;https://fonts.gstatic.com/&quot;
      crossorigin&gt;</code></pre>
            </div>
            <div class="fragment">
              <h3>As an HTTP response header:</h3>
              <pre><code class="http">Link: &lt;https://fonts.googleapis.com/&gt;;
      rel=dns-prefetch;
      crossorigin,
      &lt;https://fonts.gstatic.com/&gt;;
      rel=dns-prefetch;
      crossorigin</code></pre>
            </div>
          </section>
          <!-- [2.17] - Without `rel=dns-prefetch` -->
          <section>
            <h3>Without <code>rel=dns-prefetch</code>:</h3>
            <picture>
              <source srcset="img/no-dns-prefetch.webp" type="image/webp">
              <img src="img/no-dns-prefetch.png" alt="A browser trace showing typical DNS lookup latency for font requests without `rel=dns-prefetch` in use.">
            </picture>
            <h5>WebPagetest: Slow 3G. Dulles, VA. Emulated Motorola G (Gen4)</h5>
          </section>
          <!-- [2.18] - With `rel=dns-prefetch` -->
          <section>
            <h3>With <code>rel=dns-prefetch</code>:</h3>
            <picture>
              <source srcset="img/dns-prefetch.webp" type="image/webp">
              <img src="img/dns-prefetch.png" alt="A browser trace showing decreased DNS lookup latency for font requests with `rel=dns-prefetch` in use.">
            </picture>
            <h5>WebPagetest: Slow 3G. Dulles, VA. Emulated Motorola G (Gen4)</h5>
          </section>
          <!-- [2.19] - `rel=dns-prefetch` Support -->
          <section>
            <h3><code>rel=dns-prefetch</code> support:</h3>
            <picture>
              <source srcset="img/dns-prefetch-support-2x.webp 2x, img/dns-prefetch-support-1x.webp 1x" type="image/webp">
              <source srcset="img/dns-prefetch-support-2x.png 2x, img/dns-prefetch-support-1x.png 1x" type="image/png">
              <img src="img/dns-prefetch-support-1x.png" alt="Browser suppport matrix for rel=dns-prefetch on caniuse.com">
            </picture>
          </section>
          <!-- [2.20] - Hosting your own fonts gives you control -->
          <section class="statement-slide">
              <h2>Hosting your own fonts</h2>
              <h1 class="accent">gives you control</h1>
          </section>
          <!-- [2.21] - What you regain control of -->
          <section>
            <h2>What you regain control of:</h2>
            <ul>
              <li class="fragment">Use of anything within a <code>@font-face</code>.</li>
              <li class="fragment"><code>unicode-range</code>.</li>
              <li class="fragment"><code>font-display</code>.</li>
              <li class="fragment">Subsetting.</li>
              <li class="fragment">Easier use of <code>rel=preload</code>.</li>
            </ul>
          </section>
          <!-- [2.22] - Friendly reminder: Mind the licensing agreements! -->
          <section data-state="warning">
            <h1 class="accent">Friendly reminder:</h1>
            <h3>mind the licensing agreements!</h3>
          </section>
        </section>
        <!-- [3.0] - `font-display` for better rendering control -->
        <section>
          <!-- [3.1] - `font-display` for better rendering control -->
          <section data-state="section-slide">
            <div class="unfocused-heading">
              <h4>Host fonts on</h4>
              <h3 class="accent">on your own server</h3>
            </div>
            <div class="focused-heading">
              <h2><code>font-display</code> for better</h2>
              <h1 class="accent">rendering control</h1>
            </div>
            <div class="unfocused-heading">
              <h4><code>rel=preload</code> for</h4>
              <h3 class="accent">faster font loading</h3>
            </div>
          </section>
          <!-- [3.2] - What does `font-display` do? -->
          <section>
            <blockquote cite="https://www.w3.org/TR/css-fonts-4/#font-display-desc">
              &ldquo;The font-display descriptor for @font-face determines how a font face is displayed, based on whether and when it is downloaded and ready to use.&rdquo;<br>
              <cite>&mdash; <a href="https://www.w3.org/TR/css-fonts-4/" rel="noopener">CSS Fonts Module Level 4 Specification</a></cite>
            </blockquote>
          </section>
          <!-- [3.3] - `font-display` overrides default browser rendering strategies of web fonts -->
          <section class="statement-slide">
            <h1 class="accent">In other words,</h1>
            <h3><code>font-display</code> overrides default browser rendering strategies of web fonts.</h3>
          </section>
          <!-- [3.4] - Quick `font-display` example -->
          <section>
            <h3>A quick example:</h3>
            <pre><code class="css">@font-face {
  font-family: "Crap Sans";
  font-style: normal;
  font-weight: 400;
  src: url("../fonts/crap-sans.woff2") format("woff2"),
       url("../fonts/crap-sans.woff") format("woff");
  font-display: swap; /* &lt;-- The good stuff */
}</code></pre>
          </section>
          <!-- [3.5] - `font-display: auto` -->
          <section>
            <h3><code>font-display: auto;</code></h3>
            <h3>Browser default behavior kicks in.</h3>
          </section>
          <!-- [3.6] - `font-display: swap` -->
          <section>
            <h3><code>font-display: swap;</code></h3>
            <h3>The browser displays the first locally installed font in a <code>font-family</code> stack<span class="fragment">, then swaps in web font after it loads.</span></h3>
          </section>
          <!-- [3.7] - FOIT vs. FOUT -->
          <section data-state="foit-vs-fout centered">
            <div class="flex-item-container">
              <div>
                <picture id="foit">
                  <source srcset="img/foit.webp" type="image/webp">
                  <img src="img/foit.gif" alt="A demonstration of the Flash of Invisible Text phenomenon (FOIT)">
                </picture>
                <h3>FOIT</h3>
              </div>
              <div>
                <picture id="fout">
                  <source srcset="img/fout.webp" type="image/webp">
                  <img src="img/foit.gif" alt="A demonstration of the Flash of Unstyled Text phenomenon (FOUT)">
                </picture>
                <h3>FOUT</h3>
              </div>
            </div>
          </section>
          <!-- [3.8] - Embrace the FOUT -->
          <section>
            <h1 class="accent">Embrace the FOUT</h1>
            <ul>
              <li class="fragment">Text is never blocked from being read.</li>
              <li class="fragment">If fonts fail to download, text won't be blocked until the FOIT timeout.</li>
              <li class="fragment">First meaningful paint and speed index metrics of a page can be boosted.</li>
            </ul>
          </section>
          <!-- [3.9] Improvement stats -->
          <section>
            <h3>First Meaningful Paint (FMP) and Speed Index improvements:</h3>
            <table>
              <thead>
                <tr>
                  <th><code>font-display:</code></th>
                  <th>FMP</th>
                  <th>Speed Index</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>auto</code></td>
                  <td>3,126</td>
                  <td>2,509</td>
                </tr>
                <tr>
                  <td><code>swap</code></td>
                  <td>1,645</td>
                  <td>2,439</td>
                </tr>
              </tbody>
            </table>
          </section>
          <!-- [3.10] - Considerations with `swap` -->
          <section>
            <h2>Considerations with <code>swap</code>:</h2>
            <ul>
              <li class="fragment">Don't use it for icon fonts (use <code>font-display: block;</code> instead).</li>
              <li class="fragment"><a href="https://css-tricks.com/icon-fonts-vs-svg/" rel="noopener">Don't use icon fonts.</a> <span class="fragment">(If that's cool.)</span></li>
              <li class="fragment">Font swapping causes layout shifting.</li>
            </ul>
          </section>
          <!-- [3.11] - Font style matcher -->
          <section data-state="font-style-matcher centered">
            <picture id="font-style-matcher">
              <source srcset="img/font-style-matcher.webp" type="image/webp">
              <img src="img/font-style-matcher.gif" alt="@notwaldorf's font style matcher tool in action, comparing two fonts and attempting to align their line height and font size.">
            </picture>
            <h3><a href="https://meowni.ca/font-style-matcher/" rel="noopener">meowni.ca/font-style-matcher</a></h3>
            <h5>by <a href="https://twitter.com/notwaldorf" rel="noopener">Monica Dinculescu</a></h5>
          </section>
          <!-- [3.12] - `font-display: optional` -->
          <section>
            <h3><code>font-display: optional;</code></h3>
            <h3>FOIT occurs for a very short time. On bad connections, the browser skips loading the font, or downloads it in the background.</h3>
          </section>
          <!-- [3.13] - Learn more about `font-display` on the web -->
          <section>
            <h2>
              Learn more about<br>
              <code>font-display</code> on the web:
            </h2>
            <picture>
              <source srcset="img/css-tricks-font-display-2x.webp 2x, img/css-tricks-font-display-1x.webp 1x" type="image/webp">
              <source srcset="img/css-tricks-font-display-2x.png 2x, img/css-tricks-font-display-1x.png 1x" type="image/png">
              <img src="img/css-tricks-font-display-1x.png" alt="Screenshot of CSS-Tricks `font-display` article in the browser.">
            </picture>
            <h3><a href="https://css-tricks.com/font-display-masses/" rel="noopener">css-tricks.com/font-display-masses</a></h3>
          </section>
          <!-- [3.14] - `font-display` support -->
          <section>
            <h3><code>font-display</code> support:</h3>
            <picture>
              <source srcset="img/font-display-support-2x.webp 2x, img/font-display-support-1x.webp 1x" type="image/webp">
              <source srcset="img/font-display-support-2x.png 2x, img/font-display-support-1x.png 1x" type="image/png">
              <img src="img/font-display-support-1x.png" alt="Browser suppport matrix for `font-display` on caniuse.com">
            </picture>
          </section>
          <!-- [3.15] - Nothing bad is going to happen -->
          <section class="statement-slide">
            <h2>
              Browser doesn't support<br>
              <code>font-display</code>?
            </h2>
            <h1 class="accent fragment">Nothing bad is going to happen!</h1>
          </section>
        </section>
        <!-- [4.0] - `rel=preload` -->
        <section>
          <!-- [4.1] - Accelerate font rendering with `rel=preload` -->
          <section data-state="section-slide">
            <div class="unfocused-heading">
              <h4><code>font-display</code> for better</h4>
              <h3 class="accent">rendering control</h3>
            </div>
            <div class="focused-heading">
              <h2><code>rel=preload</code> for</h2>
              <h1 class="accent">faster font loading</h1>
            </div>
            <div class="unfocused-heading">
              <h4><code>Save-Data</code> and skip</h4>
              <h3 class="accent">unnecessary fonts</h3>
            </div>
          </section>
          <!-- [4.2] - What is `rel=preload`? -->
          <section>
            <blockquote cite="https://www.w3.org/TR/preload/#early-fetch-of-critical-resources">
              &quot;...most resource declarations specified within JavaScript and CSS are 'hidden' from the speculative parsers and incur a performance penalty. To address this, the application can use a preload link to declaratively specify which resources the user agent must fetch early to improve page performance.&quot;
              <cite>&mdash; <a href="https://www.w3.org/TR/preload/#early-fetch-of-critical-resources" rel="noopener">Preload Specification, &sect; A.1</a></cite>
            </blockquote>
          </section>
          <!-- [4.3] - In other words -->
          <section class="statement-slide">
            <h1 class="accent">In other words,</h1>
            <h3><code>rel=preload</code> initiates an early fetch for a resource before the browser knows it even needs it.</h3>
          </section>
          <!-- [4.4] - Using `rel=preload` -->
          <section>
            <div>
              <h3>In HTML:</h3>
              <pre><code class="html">&lt;link rel=&quot;preload&quot;
      href=&quot;/css/fonts/firasans-regular.woff2&quot;
      as=&quot;font&quot;
      type=&quot;font/woff2&quot;
      crossorigin&gt;</code></pre>
            </div>
            <div class="fragment">
              <h3>As an HTTP response header:</h3>
              <pre><code class="http">Link: &lt;/css/fonts/firasans-regular.woff2&gt;;
      rel=preload;
      as=font;
      type=font/woff2;
      crossorigin;
      nopush</code></pre>
            </div>
          </section>
          <!-- [4.5] - Critical request chain without `rel=preload` -->
          <section>
            <h3>
                Critical request chain<br>
                without any preloading:
            </h3>
            <picture>
              <source srcset="img/crp-no-preload-2x.webp 2x, img/crp-no-preload-1x.webp 1x" type="image/webp">
              <source srcset="img/crp-no-preload-2x.png 2x, img/crp-no-preload-1x.png 1x" type="image/png">
              <img class="stretch" src="img/crp-no-preload-1x.png" alt="A suboptimal critical request chain as audited by Lighthouse.">
            </picture>
          </section>
          <!-- [4.6] - Critical request chain with `rel=preload` -->
          <section>
            <h3>
                Critical request chain with<br>
                font and CSS preloading:
            </h3>
            <picture>
              <source srcset="img/crp-preload-2x.webp 2x, img/crp-preload-1x.webp 1x" type="image/webp">
              <source srcset="img/crp-preload-2x.png 2x, img/crp-preload-1x.png 1x" type="image/png">
              <img class="stretch" src="img/crp-preload-1x.png" alt="An optimized critical request chain as audited by Lighthouse.">
            </picture>
          </section>
          <!-- [4.7] - Normal downloading of font assets (without `rel=preload`) -->
          <section>
            <h3>Normal font retrieval:</h3>
            <picture>
              <source srcset="img/waterfall-no-preload.webp" type="image/webp">
              <img class="stretch" src="img/waterfall-no-preload.png" alt="A resource waterfall graph of a page with fonts downloaded in their natural order.">
            </picture>
            <h5>WebPagetest: 2G. Mumbai. Emulated Motorola G (Gen1)</h5>
          </section>
          <!-- [4.8] - Font assets reprioritized (with `rel=preload`) -->
          <section>
            <h3>Reprioritizing with <code>rel=preload</code>:</h3>
            <picture>
              <source srcset="img/waterfall-preload.webp" type="image/webp">
              <img class="stretch" src="img/waterfall-preload.png" alt="A resource waterfall graph of a page with fonts effectively reprioritized using `rel=preload`.">
            </picture>
            <h5>WebPagetest: 2G. Mumbai. Emulated Motorola G (Gen1)</h5>
          </section>
          <!-- [4.9] - Timeline Comparison -->
          <section>
            <h3>Without <code>rel=preload</code> <span style="font-size: .625em;">⤵</span></h3>
            <div class="scroll-container">
              <picture class="scroll-container">
                <source srcset="img/preload-swap-timeline.webp" type="image/webp">
                <img width="3310" height="472" src="img/preload-swap-timeline.png" alt="A comparison of screenshot rolls of a page loading with fonts loading normally vs. loading via `rel=preload`.">
              </picture>
            </div>
            <h3>With <code>rel=preload</code> <span style="font-size: .625em;">⤴</span></h3>
          </section>
          <!-- [4.10] - A Few Friendly Reminders -->
          <section data-state="warning">
            <h1 class="accent">Friendly reminders:</h1>
            <ul>
              <li class="fragment">Omitting the <code>as</code> attribute causes resources to be downloaded twice. Supply a value of <code>font</code> for fonts.</li>
              <li class="fragment">Supply the resource's content type via the <code>type</code> attribute so browsers don't download resources they can't use.</li>
              <li class="fragment">You <u>must</u> specify a <code>crossorigin</code> attribute for font resources. <span class="fragment">(<a href="https://drafts.csswg.org/css-fonts/#font-fetching-requirements" rel="noopener">Yes, even for fonts on your own server</a>.)</span></li>
            </ul>
          </section>
          <!-- [4.11] - A few more things -->
          <section data-state="warning">
            <h1 class="accent">A few more things:</h1>
            <ul>
              <li class="fragment">Don't preload things you aren't going to use on the page! <span class="fragment">(Use <code>rel=prefetch</code> for that)</span></li>
              <li class="fragment">Don't preload everything and the kitchen sink!</li>
              <li class="fragment">If specifying <code>rel=preload</code> as an HTTP header, use the <code>nopush</code> flag to prevent unwanted server pushes. <span class="fragment">(<a href="https://jakearchibald.com/2017/h2-push-tougher-than-i-thought/" rel="noopener">Server push is kind of tough</a>.)</span></li>
            </ul>
          </section>
        </section>
        <!-- [5.0] - `Save-Data` -->
        <section>
          <!-- [5.1] - Skip "nice to have" fonts using `Save-Data` -->
          <section data-state="section-slide">
            <div class="unfocused-heading">
              <h4><code>rel=preload</code> for</h4>
              <h3 class="accent">faster font loading</h3>
            </div>
            <div class="focused-heading">
              <h2><code>Save-Data</code> and skip</h2>
              <h1 class="accent">unnecessary fonts</h1>
            </div>
            <div class="unfocused-heading">
              <h4>Time to</h4>
              <h3 class="accent">wrap it up</h3>
            </div>
          </section>
          <!-- [5.2] - What is `Save-Data`? -->
          <section>
            <blockquote cite="https://tools.ietf.org/html/draft-ietf-httpbis-client-hints-05#section-3.4">
              &quot;The <code>Save-Data</code> request header field consists of one or more tokens that indicate client's preference for reduced data usage, due to high transfer costs, slow connection speeds, or other reasons.&quot;
              <cite>&mdash; <a href="https://tools.ietf.org/html/draft-ietf-httpbis-client-hints-05#section-3.4" rel="noopener">HTTP Client Hints Specification, &sect; 3.4</a></cite>
            </blockquote>
          </section>
          <!-- [5.3] - In other words -->
          <section class="statement-slide">
            <h1 class="accent">In other words,</h1>
            <h3><code>Save-Data</code> is a header sent by clients in a "data saver" mode. <span class="fragment">Applications can deliver less resources if it is present</span>.</h3>
          </section>
          <!-- [5.4] - How `Save-Data` works (Pt. I) -->
          <section data-state="centered">
            <h3>Toggle data saver:</h3>
            <picture>
              <source srcset="img/data-saver-android-2x.webp 2x, img/data-saver-android-1x.webp 1x" type="image/webp">
              <source srcset="img/data-saver-android-2x.png 2x, img/data-saver-android-1x.png 1x" type="image/png">
              <img src="img/data-saver-android-1x.png" alt="A settings screen in Chrome where a user can toggle the data saver mode, along with a readout of bytes saved.">
            </picture>
          </section>
          <!-- [5.5] - How `Save-Data` works (Pt. II) -->
          <section data-state="centered">
            <h3>Browser sends a <code>Save-Data</code> header with a value of <code>On</code> for every request:</h3>
            <picture>
              <source srcset="img/save-data-header-2x.webp 2x, img/save-data-header-1x.webp 1x" type="image/webp">
              <source srcset="img/save-data-header-2x.png 2x, img/save-data-header-1x.png 1x" type="image/png">
              <img class="stretch larger" src="img/save-data-header-1x.png" alt="Request headers for font resources shown in Chrome dev tools, with the `Save-Data` header at the bottom of the list.">
            </picture>
          </section>
          <!-- [5.6] - `Save-Data` use cases -->
          <section>
            <h2><code>Save-Data</code> use cases:</h2>
            <ul>
              <li class="fragment">Serve low resolution imagery for high-res screens.</li>
              <li class="fragment">Stream lower quality video.</li>
              <li class="fragment">Opt out of server pushes.</li>
              <li class="fragment">Opt out of non-essential media.</li>
              <li class="fragment">Opt out of &quot;nice-to-have&quot; web fonts.</li>
            </ul>
          </section>
          <!-- [5.7] - Detect `Save-Data` -->
          <section>
            <h2>Detect <code>Save-Data</code>:</h2>
            <pre><code class="php">&lt;?php
$saveData = false;

if(isset($_SERVER["HTTP_SAVE_DATA"]) &&
   strtolower($_SERVER["HTTP_SAVE_DATA"]) === "on") {
  $saveData = true;
}
?&gt;</code></pre>
          </section>
          <!-- [5.8] - Conditionally serve `@font-faces` -->
          <section>
            <h3>Add a class to the html element:</h3>
            <pre><code class="php">&lt;?php
if($saveData === true){
  $saveDataClass = "save-data";
} else {
  $saveDataClass = "no-save-data";
}
?&gt;

&lt;html class=&quot;&lt;?php echo($saveDataClass); ?&gt;&quot;&gt;</code></pre>
            <div class="fragment">
              <h3>Modify CSS:</h3>
              <pre><code class="css">h1, p {
  font-family: "Helvetica", sans-serif;
}

.no-save-data h1, .no-save-data p {
  font-family: "Optional Sans", "Helvetica", sans-serif;
}</code></pre>
            </div>
          </section>
          <!-- [5.10] - `Save-Data` kicks in -->
          <section data-state="centered">
            <div>
              <h3>Without:</h3>
              <picture>
                <source srcset="img/save-data-off-2x.webp 2x, img/save-data-off-1x.webp 1x" type="image/webp">
                <source srcset="img/save-data-off-2x.png 2x, img/save-data-off-1x.png 1x" type="image/png">
                <img class="stretch larger" src="img/save-data-off-1x.png" alt="A list of font resources in Chrome's network panel, showing all fonts downloaded when `Save-Data` is off.">
              </picture>
            </div>
            <div class="fragment">
              <h3>With:</h3>
              <picture>
                <source srcset="img/save-data-on-2x.webp 2x, img/save-data-on-1x.webp 1x" type="image/webp">
                <source srcset="img/save-data-on-2x.png 2x, img/save-data-on-1x.png 1x" type="image/png">
                <img class="stretch larger" src="img/save-data-on-1x.png" alt="A list of font resources in Chrome's network panel, showing only a few fonts downloaded because `Save-Data` is on.">
              </picture>
            </div>
          </section>
          <!-- [5.11] - Typeface differences -->
          <section data-state="centered">
            <div class="flex-item-container">
              <div>
                <h3>Without:</h3>
                <picture>
                  <source srcset="img/more-typefaces-2x.webp 2x, img/more-typefaces-1x.webp 1x" type="image/webp">
                  <source srcset="img/more-typefaces-2x.png 2x, img/more-typefaces-1x.png 1x" type="image/png">
                  <img class="full" src="img/more-typefaces-1x.png" alt="A page rendering with the body copy in a web font.">
                </picture>
                <h5>Fira Sans</h5>
              </div>
              <div class="fragment">
                <h3>With:</h3>
                <picture>
                  <source srcset="img/less-typefaces-2x.webp 2x, img/less-typefaces-1x.webp 1x" type="image/webp">
                  <source srcset="img/less-typefaces-2x.png 2x, img/less-typefaces-1x.png 1x" type="image/png">
                  <img class="full" src="img/less-typefaces-1x.png" alt="A page rendering with the body copy in a system font because `Save-Data` is on.">
                </picture>
                <h5>System sans</h5>
              </div>
            </div>
          </section>
          <!-- [5.12] - Learn more about `Save-Data` on the web -->
          <section>
            <h2>
              Learn more about<br>
              <code>Save-Data</code> on the web:
            </h2>
            <picture>
              <source srcset="img/css-tricks-save-data-2x.webp 2x, img/css-tricks-save-data-1x.webp 1x" type="image/webp">
              <source srcset="img/css-tricks-save-data-2x.png 2x, img/css-tricks-save-data-1x.png 1x" type="image/png">
              <img src="img/css-tricks-save-data-1x.png" alt="Screenshot of CSS-Tricks `Save-Data` article in the browser.">
            </picture>
            <h3><a href="https://css-tricks.com/help-users-save-data/" rel="noopener">css-tricks.com/help-users-save-data</a></h3>
          </section>
        </section>
        <!-- [6.0] - Closing -->
        <section>
          <!-- [6.1] - Wrap it up -->
          <section data-state="section-slide">
            <div class="unfocused-heading">
              <h4><code>Save-Data</code> and skip</h4>
              <h3 class="accent">unnecessary fonts</h3>
            </div>
            <div class="focused-heading">
              <h2>Time to</h2>
              <h1 class="accent">wrap it up</h1>
            </div>
            <div class="unfocused-heading">
              <h4>&nbsp;</h4>
              <h3 class="accent">&nbsp;</h3>
            </div>
          </section>
          <!-- [6.2] - With thanks to -->
          <section data-state="section-slide centered">
            <h1 class="accent">With thanks to:</h1>
            <div class="people">
              <div class="person">
                <img src="img/people/ben-schwarz.jpg" alt="Ben Schwarz">
                <p>
                  Ben Schwarz<br>
                  <a href="https://twitter.com/benschwarz" rel="noopener">@benschwarz</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/karolina-szczur.jpg" alt="Karolina Szczur">
                <p>
                  Karolina Szczur<br>
                  <a href="https://twitter.com/fox" rel="noopener">@fox</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/zach-leatherman.jpg" alt="Zach Leatherman">
                <p>
                  Zach Leatherman<br>
                  <a href="https://twitter.com/zachleat" rel="noopener">@zachleat</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/addy-osmani.jpg" alt="Addy Osmani">
                <p>
                  Addy Osmani<br>
                  <a href="https://twitter.com/addyosmani" rel="noopener">@addyosmani</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/monica-dinculescu.jpg" alt="Monica Dinculescu">
                <p>
                  Monica Dinculescu<br>
                  <a href="https://twitter.com/notwaldorf" rel="noopener">@notwaldorf</a>
                </p>
              </div>
              <div class="person">
                <img src="img/people/ilya-grigorik.jpg" alt="Ilya Grigorik">
                <p>
                  Ilya Grigorik<br>
                  <a href="https://twitter.com/igrigorik" rel="noopener">@igrigorik</a>
                </p>
              </div>
            </div>
          </section>
          <!-- [6.3] - ...and thank you! -->
          <section data-state="section-slide centered">
            <h1 class="accent">...and thank you!</h1>
          </section>
          <!-- [6.4] - Slide deck link -->
          <section data-state="section-slide centered">
            <h1 class="accent">Slide deck link:</h1>
            <h3><a href="http://jlwagner.net/talks/faster-fonts" rel="noopener">jlwagner.net/talks/faster-fonts</a></h3>
          </section>
          <!-- [6.5] - End -->
          <section data-state="bookend end-card centered">
            <img class="stretch" src="img/end-card.svg" alt="A man flying through the sky on a jet pack.">
            <h2 class="accent end">End!</h2>
          </section>
        </section>
      </div>
    </div>
    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script>
      Reveal.initialize({
        history: true,
        controls: false,
        transition: "none",
        progress: false,
        viewDistance: 2,
        help: false,
        dependencies: [{
            src: 'plugin/notes/notes.js',
            async: true
          },
          {
            src: 'plugin/highlight/highlight.js',
            async: true,
            callback: function(){
              hljs.initHighlightingOnLoad();
            }
          }
        ]});

        Reveal.addEventListener("slidechanged", function(e){
          Reveal.setState(Reveal.getState());
        });
    </script>
  </body>
</html>
